"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8989],{35318:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>c});var o=t(27378);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=o.createContext({}),m=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=m(e.components);return o.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=m(t),c=a,h=d["".concat(s,".").concat(c)]||d[c]||u[c]||r;return t?o.createElement(h,l(l({ref:n},p),{},{components:t})):o.createElement(h,l({ref:n},p))}));function c(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,l=new Array(r);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var m=2;m<r;m++)l[m]=t[m];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},802:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>m});var o=t(25773),a=(t(27378),t(35318));const r={sidebar_position:30},l="Troubleshooting Podman on macOS",i={unversionedId:"troubleshooting/troubleshooting-podman-on-macos",id:"troubleshooting/troubleshooting-podman-on-macos",title:"Troubleshooting Podman on macOS",description:"Unable to set custom binary path for Podman on macOS",source:"@site/docs/troubleshooting/troubleshooting-podman-on-macos.md",sourceDirName:"troubleshooting",slug:"/troubleshooting/troubleshooting-podman-on-macos",permalink:"/docs/troubleshooting/troubleshooting-podman-on-macos",draft:!1,editUrl:"https://github.com/containers/podman-desktop/tree/main/website/docs/troubleshooting/troubleshooting-podman-on-macos.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{sidebar_position:30},sidebar:"mySidebar",previous:{title:"Troubleshooting Podman on Windows",permalink:"/docs/troubleshooting/troubleshooting-podman-on-windows"},next:{title:"Troubleshooting Podman on Linux",permalink:"/docs/troubleshooting/troubleshooting-podman-on-linux"}},s={},m=[{value:"Unable to set custom binary path for Podman on macOS",id:"unable-to-set-custom-binary-path-for-podman-on-macos",level:2},{value:"Issue",id:"issue",level:4},{value:"Solution",id:"solution",level:4},{value:"Unable to locate Podman Engine",id:"unable-to-locate-podman-engine",level:2},{value:"Issue",id:"issue-1",level:4},{value:"Explanation",id:"explanation",level:4},{value:"Solution",id:"solution-1",level:4},{value:"Podman machine on Apple Silicon",id:"podman-machine-on-apple-silicon",level:2},{value:"Issue",id:"issue-2",level:4},{value:"Explanation",id:"explanation-1",level:4},{value:"Solution",id:"solution-2",level:4},{value:"Recovering from a failed start",id:"recovering-from-a-failed-start",level:2},{value:"Workaround",id:"workaround",level:4},{value:"Solution",id:"solution-3",level:4},{value:"Podman machine not starting with QEMU 8.1.0 from brew",id:"podman-machine-not-starting-with-qemu-810-from-brew",level:2},{value:"Solution",id:"solution-4",level:4},{value:"Workaround",id:"workaround-1",level:4},{value:"Additional resources",id:"additional-resources",level:4}],p={toc:m};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"troubleshooting-podman-on-macos"},"Troubleshooting Podman on macOS"),(0,a.kt)("h2",{id:"unable-to-set-custom-binary-path-for-podman-on-macos"},"Unable to set custom binary path for Podman on macOS"),(0,a.kt)("h4",{id:"issue"},"Issue"),(0,a.kt)("p",null,"When setting a custom binary path (under Preferences -> Custom binary path), Podman is unable to find ",(0,a.kt)("inlineCode",{parentName:"p"},"gvproxy")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"podman-mac-helper"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'Error: unable to start host networking: "could not find \\"gvproxy\\" in one of [/usr/local/opt/podman/libexec /opt/homebrew/bin /opt/homebrew/opt/podman/libexec /usr/local/bin /usr/local/libexec/podman /usr/local/lib/podman /usr/libexec/podman /usr/lib/podman $BINDIR/../libexec/podman].  To resolve this error, set the helper_binaries_dir key in the `[engine]` section of containers.conf to the directory containing your helper binaries."\n')),(0,a.kt)("h4",{id:"solution"},"Solution"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Download ",(0,a.kt)("inlineCode",{parentName:"li"},"gvproxy")," from the ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/containers/gvisor-tap-vsock/releases"},"gvisor-tap-vsock release page"),"."),(0,a.kt)("li",{parentName:"ol"},"Build the ",(0,a.kt)("inlineCode",{parentName:"li"},"podman-mac-helper")," from the source code on the ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/containers/podman/tree/main/cmd/podman-mac-helper"},"Podman GitHub page"),"."),(0,a.kt)("li",{parentName:"ol"},"Add the ",(0,a.kt)("inlineCode",{parentName:"li"},"helpers_binaries_dir")," entry to ",(0,a.kt)("inlineCode",{parentName:"li"},"~/.config/containers/conf"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'[containers]\n\nhelper_binaries_dir=["/Users/user/example_directory"]\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"NOTE"),": A pre-built binary will be added to the Podman release page so you do not have to build ",(0,a.kt)("inlineCode",{parentName:"p"},"podman-mac-helper"),". An ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/containers/podman/issues/16746"},"issue is open for this"),"."),(0,a.kt)("h2",{id:"unable-to-locate-podman-engine"},"Unable to locate Podman Engine"),(0,a.kt)("h4",{id:"issue-1"},"Issue"),(0,a.kt)("p",null,"Despite having Podman Engine installed, you might receive an error as follows -\n",(0,a.kt)("inlineCode",{parentName:"p"},"Error: No such keg: /usr/local/Cellar/podman"),"\nor any similar error denoting that Podman Engine does not exist."),(0,a.kt)("h4",{id:"explanation"},"Explanation"),(0,a.kt)("p",null,"The Podman Installer and Homebrew use different locations to store the Podman Engine files in the file system. For example, Podman Installer installs Podman Engine in the path ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/podman")," whereas Homebrew uses the path ",(0,a.kt)("inlineCode",{parentName:"p"},"/usr/local")," for macOS Intel, ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/homebrew")," for Apple Silicon and ",(0,a.kt)("inlineCode",{parentName:"p"},"/home/linuxbrew/.linuxbrew")," for Linux."),(0,a.kt)("h4",{id:"solution-1"},"Solution"),(0,a.kt)("p",null,"To check where exactly is your Podman Engine installed, run the command-"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"which podman\n")),(0,a.kt)("p",null,"This returns the path where the Podman Engine would be installed. This would help determine further action."),(0,a.kt)("p",null,"For example, if you\u2019re looking to completely uninstall Podman Engine from your system for a fresh installation, running ",(0,a.kt)("inlineCode",{parentName:"p"},"which podman")," returns the exact path where Podman still exists. This could be the path where Podman Installer stores Podman Engine, such as ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/podman"),". Once you know the path, run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"sudo rm -rf /opt/podman\n")),(0,a.kt)("p",null,"Or"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"sudo rm -rf path-where-podman-exists\n")),(0,a.kt)("p",null,"Here, you would replace ",(0,a.kt)("inlineCode",{parentName:"p"},"path-where-podman-exists")," with the output of ",(0,a.kt)("inlineCode",{parentName:"p"},"which podman"),"."),(0,a.kt)("p",null,"You can now proceed for a fresh installation of Podman Desktop"),(0,a.kt)("h2",{id:"podman-machine-on-apple-silicon"},"Podman machine on Apple Silicon"),(0,a.kt)("h4",{id:"issue-2"},"Issue"),(0,a.kt)("p",null,"If you are using an Apple Silicon and brew, you might encounter the following error when starting Podman from Podman Desktop"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell-session"},"Error: qemu exited unexpectedly with exit code 1, stderr: qemu-system-x86_64: invalid accelerator hvf\nqemu-system-x86_64: falling back to tcg\nqemu-system-x86_64: unable to find CPU model 'host'\n")),(0,a.kt)("h4",{id:"explanation-1"},"Explanation"),(0,a.kt)("p",null,"Podman machine is running as a ",(0,a.kt)("inlineCode",{parentName:"p"},"x86_64")," process and it could be due to a dual install of homebrew: one for ",(0,a.kt)("inlineCode",{parentName:"p"},"x86_64")," and one for ",(0,a.kt)("inlineCode",{parentName:"p"},"arm64"),"."),(0,a.kt)("h4",{id:"solution-2"},"Solution"),(0,a.kt)("p",null,"You can"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Uninstall Podman machine on your ",(0,a.kt)("inlineCode",{parentName:"li"},"x86_64")," brew install (for example from a terminal running under rosetta) ",(0,a.kt)("inlineCode",{parentName:"li"},"brew uninstall podman")),(0,a.kt)("li",{parentName:"ol"},"or uninstall brew ",(0,a.kt)("inlineCode",{parentName:"li"},"x86_64")," as most brew receipe have now arm64 support: follow ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/homebrew/install#uninstall-homebrew"},"these instructions")," from a terminal running under rosetta")),(0,a.kt)("p",null,"Then run a terminal in native mode (default) and install Podman machine ",(0,a.kt)("inlineCode",{parentName:"p"},"brew install podman")),(0,a.kt)("p",null,"Finally clean the Podman machine VMs that had been previously created, and create new ones."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell-session"},"$ podman machine rm podman-machine-default\n$ podman machine init\n")),(0,a.kt)("p",null,"You should be a happy camper from here."),(0,a.kt)("h2",{id:"recovering-from-a-failed-start"},"Recovering from a failed start"),(0,a.kt)("p",null,"After a failed start, the Podman machine might be unable to start because a QEMU process is still running and the PID file is in use."),(0,a.kt)("h4",{id:"workaround"},"Workaround"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Kill the remaining QEMU process and stop the Podman machine:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell-session"},"$ ps -edf | grep qemu-system | grep -v grep | awk '{print $2}' | xargs -I{} kill -9 {}; podman machine stop\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Start the Podman machine."))),(0,a.kt)("h4",{id:"solution-3"},"Solution"),(0,a.kt)("p",null,"Use Podman 4.6.1 or greater."),(0,a.kt)("h2",{id:"podman-machine-not-starting-with-qemu-810-from-brew"},"Podman machine not starting with QEMU 8.1.0 from brew"),(0,a.kt)("p",null,"When you installed Podman and QEMU with brew, and QEMU version is 8.1.0, Podman machine might fail to start with an error such as:\n",(0,a.kt)("inlineCode",{parentName:"p"},"Error: qemu exited unexpectedly with exit code -1, stderr: qemu-system-x86_64: Error: HV_DENIED")),(0,a.kt)("h4",{id:"solution-4"},"Solution"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/installation/macos-install"},"Install Podman Desktop and Podman using the .dmg installer")," rather than brew.\nThe Podman installer has a QEMU binary that has been tested with Podman.")),(0,a.kt)("h4",{id:"workaround-1"},"Workaround"),(0,a.kt)("p",null,"Keep your brew-based installation and apply one of these workarounds:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Rollback the QEMU brew package to v8.0.3."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell-session"},"$ brew uninstall qemu\n$ curl -OSL https://raw.githubusercontent.com/Homebrew/homebrew-core/dc0669eca9479e9eeb495397ba3a7480aaa45c2e/Formula/qemu.rb\n$ brew install ./qemu.rb\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Alternatively, sign the QEMU brew binary locally:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell-session"},'$ cat >entitlements.xml <<EOF\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">\n<dict>\n  <key>com.apple.security.hypervisor</key>\n  <true/>\n</dict>\n</plist>\nEOF\n$ codesign --sign - --entitlements entitlements.xml --force /usr/local/bin/qemu-system-$(uname -m | sed -e s/arm64/aarch64/)\n')))),(0,a.kt)("h4",{id:"additional-resources"},"Additional resources"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/Homebrew/homebrew-core/issues/140244"},"Homebrew issue #140244"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/containers/podman/issues/19708"},"Podman issue #19708"),".")))}u.isMDXComponent=!0}}]);